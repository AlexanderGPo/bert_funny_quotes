<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:site_name" content="Quotes Dataset Markup">
    <meta property="og:title" content="QDM | –†–∞–∑–º–µ—Ç–∫–∞ —Ü–∏—Ç–∞—Ç –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π"/>
    <meta property="og:description"
          content="–ü—Ä–∏–≤–µ—Ç. –ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω—É–∂–Ω–æ —Ä–∞–∑–º–µ—Ç–∏—Ç—å —Ä–µ–∫–æ—Ä–¥–Ω–æ –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–∏—Ç–∞—Ç. –ë—É–¥–µ–º –ø—Ä–∏–∑–Ω–∞—Ç–µ–ª—å–Ω—ã –∑–∞ –ø–æ–º–æ—â—å!">
    <meta property="og:image" content="{{ url_for('static', filename='preview.png') }}"/>
    <meta property="twitter:image" content="{{ url_for('static', filename='preview.png') }}"/>

    <title>Quotes Dataset Markup</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

        ::-moz-selection {
            color: white;
            background: #6d8af3;
        }

        ::selection {
            color: white;
            background: #6d8af3;
        }

        body {
            font-family: 'Roboto', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            transition: background-color 0.5s, color 0.5s;
            position: relative;
        }

        #quote-container {
            user-select: none;
            position: absolute;
            top: 130px;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
            text-align: center;
            transition: background-color 0.5s;
        }

        #quote-container::after {
          content: "";
          position: absolute;
          bottom: -80px;
          height: 1px;
          width: 1px;
        }

        #quote-text {
            user-select: text;
            font-size: 30px;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .btn {
            margin: 10px;
            padding: 12px 30px;
            font-size: 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
            color: white;
            user-select: none;
        }

        .btn-positive {
            background-color: #34d058;
        }

        .btn-positive:hover {
            background-color: #28a745;
            transform: translateY(-2px);
        }

        .btn-negative {
            background-color: #f66a6a;
        }

        .btn-negative:hover {
            background-color: #dc3545;
            transform: translateY(-2px);
        }

        .btn-report {
            background-color: #8c8c8c;
        }

        .btn-report:hover {
            background-color: #6c757d;
            transform: translateY(-2px);
        }

        .btn-skip {
            background-color: #ffdf7e;
            color: black;
        }

        .btn-skip:hover {
            background-color: #ffc107;
            transform: translateY(-2px);
        }

        .btn-nsfw {
            background-color: #6d8af3;
            color: white;
        }

        .btn-nsfw:hover {
            background-color: #4a6ef0;
            transform: translateY(-2px);
        }

        .theme-switch {
            position: absolute;
            top: 70px;
            user-select: none;
            right: 15px;
            padding: 10px 17px;
            font-size: 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #008cba;
            color: white;
            transition: background-color 0.3s, transform 0.3s;
        }

        .theme-switch:hover {
            background-color: #007bb5;
            transform: translateY(-2px);
        }

        .show-info-btn {
            position: absolute;
            top: 20px;
            right: 15px;
            padding: 10px 17px;
            font-size: 15px;
            border: none;
            user-select: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #008cba;
            color: white;
            transition: background-color 0.3s, transform 0.3s;
        }

        .show-info-btn:hover {
            background-color: #007bb5;
            transform: translateY(-2px);
        }

        .nsfw-btn {
            position: absolute;
            top: 70px;
            right: 159px;
            padding: 10px 17px;
            font-size: 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #ed7a2b;
            user-select: none;
            color: white;
            transition: background-color 0.3s, transform 0.3s;
        }

        .nsfw-btn:hover {
            transform: translateY(-2px);
        }

        .link-devices-btn {
            position: absolute;
            top: 20px;
            right: 165px;
            padding: 10px 17px;
            font-size: 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #008cba;
            user-select: none;
            color: white;
            transition: background-color 0.3s, transform 0.3s;
        }

        .link-devices-btn:hover {
            background-color: #007bb5;
            transform: translateY(-2px);
        }

        #linking-modal {
            display: none;
            position: fixed;
            z-index: 5;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
        }

        #linking-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 30px;
            border: 1px solid #888;
            width: 75%;
            max-width: 720px;
            border-radius: 10px;
            text-align: left;
            font-size: 20px;
            position: relative;
            line-height: 1.5;
        }

        #generate-btn {
            background-color: #008cba;
            color: white;
            padding: 5px 10px;
            font-size: 17px;
            min-width: 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
        }

        #linking-input {
            border: 3px solid #008cba;
            width: 100px;
            color: #000000;
            padding: 5px;
            border-radius: 10px;
            font-size: 17px;
            background: #FFF;
        }

        #linking-input:focus {
            outline: none;
            background: #E5EBF7;
        }

        .channel-link {
            display: inline-block;
            margin: 5px 0;
            color: #008cba;
            text-decoration: none;
            font-size: 20px;
        }

        .channel-link:hover {
            text-decoration: underline;
        }

        /* Modal Styles */
        #welcome-modal {
            display: none;
            position: fixed;
            z-index: 5;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
        }

        #welcome-content {
            background-color: #fefefe;
            margin: 3% auto;
            padding: 30px;
            border: 1px solid #888;
            width: 75%;
            max-width: 720px;
            border-radius: 10px;
            text-align: left;
            font-size: 20px;
            position: relative;
            line-height: 1.5;
        }

        .welcome-header {
            font-size: 25px;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }

        .welcome-subheader {
            text-align: center;
            font-size: 25px;
            font-weight: bold;
            margin: 10px 0 7px 0;
        }

        .welcome-links a {
            display: inline-block;
            color: #008cba;
            text-decoration: none;
        }

        .welcome-links a:hover {
            text-decoration: underline;
        }

        .link-devices-btn-welcome {
            padding: 5px 10px;
            font-size: 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #008cba;
            user-select: none;
            color: white;
            pointer-events: none;
            transition: background-color 0.3s, transform 0.3s;
        }

        .copy-btn {
            user-select: none;
            background-color: #008cba;
            color: white;
            padding: 5px;
            min-width: 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
        }

        .copy-btn:hover {
            background-color: #007bb5;
            transform: translateY(-2px);
        }

        .close-btn {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #008cba;
            color: white;
            transition: background-color 0.3s, transform 0.3s;
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            user-select: none;
        }

        .close-btn:hover {
            background-color: #007bb5;
            transform: translateY(-2px), translateX(-50%);
        }

        .welcome-btn {
            margin: 7px 0;
            padding: 6px 15px;
            font-size: 20px;
            user-select: none;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
            color: white;
            pointer-events: none;
        }

        #welcome-btn-nsfw {
            margin: 7px 0;
            padding: 6px 15px;
            font-size: 15px;
            border: none;
            user-select: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #ed7a2b;
            color: white;
            transition: background-color 0.3s, transform 0.3s;
            pointer-events: none;
        }

        #quote-cnt {
            text-align: left;
            font-size: 30px;
        }

        .btn-skip {
            background-color: #ffdf7e;
            color: black;
        }

        /* Light Theme */
        body.light-theme {
            background-color: #f7f7f7;
            color: #333333;
        }

        body.light-theme #quote-container {
            background: #ffffff;
        }

        /* Dark Theme */
        body.dark-theme {
            background-color: #1a1a1a;
            color: #f5f5f5;
        }

        body.dark-theme #quote-container {
            background: #333333;
        }

        body.dark-theme #welcome-content {
            background: #333333;
        }


    </style>
</head>
<body class="dark-theme">

<button class="theme-switch" onclick="toggleTheme()">–î—Ä—É–≥–∞—è —Ç–µ–º–∞</button>
<button class="show-info-btn" onclick="showWelcomeModal()">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</button>
<button class="nsfw-btn" onclick="nsfwOn()">–ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º</button>
<button class="link-devices-btn" onclick="showLinkingModal()">–°–≤—è–∑–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</button>

<div id="quote-container">
    <div id="quote-cnt">#42</div>
    <br>
    <a id="channel-link" class="channel-link" href="#" target="_blank">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Å—ã–ª–∫–∏...</a>
    <div id="quote-text">–ó–∞–≥—Ä—É–∑–∫–∞ —Ü–∏—Ç–∞—Ç—ã...</div>
    <button class="btn btn-positive" onclick="vote('positive')">–ü–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å</button>
    <button class="btn btn-negative" onclick="vote('negative')">–ù–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å</button>
    <button class="btn btn-report" onclick="report()">–ù–µ —Ü–∏—Ç–∞—Ç–∞</button>
    <!-- <button class="btn btn-skip" onclick="proceed()">–£–∂–µ –±—ã–ª–æ</button> -->
    <button class="btn btn-nsfw" onclick="nsfwQuote()">–ù–µ–ø—Ä–∏–µ–º–ª–µ–º–æ</button>
</div>

<!-- Welcome Modal -->
<div id="welcome-modal" onclick="closeWelcomeModal(event)">
    <div id="welcome-content" onclick="event.stopPropagation()">
        <div class="welcome-header">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</div>
        <div>–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –æ–±—Ä–∞—Ç–∏–ª–∏ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∏ –≥–æ—Ç–æ–≤—ã –Ω–∞–º –ø–æ–º–æ—á—å :D<br>
            –£ –≤–∞—Å –µ—Å—Ç—å 4 –æ–ø—Ü–∏–∏ –ø—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ —Ä–µ—à–µ–Ω–∏–π –æ —Ü–∏—Ç–∞—Ç–∞—Ö:
        </div>
        <div>
            <button class="welcome-btn btn-positive" disabled>–ü–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å</button>
            ‚Äì —Ü–∏—Ç–∞—Ç–∞ —Å–º–µ—à–Ω–∞—è.
        </div>
        <div>
            <button class="welcome-btn btn-negative" disabled>–ù–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å</button>
            ‚Äì —Ü–∏—Ç–∞—Ç–∞ –Ω–µ—Å–º–µ—à–Ω–∞—è.
        </div>
        <div>
            <button class="welcome-btn btn-report" disabled>–ù–µ —Ü–∏—Ç–∞—Ç–∞</button>
            ‚Äì —ç—Ç–æ –Ω–µ —Ü–∏—Ç–∞—Ç–∞ (—Ä–µ–∫–ª–∞–º–∞ / –ª—é–±–æ–π –¥—Ä—É–≥–æ–π —Ç–µ–∫—Å—Ç).
        </div>
        <div>
            <button class="welcome-btn btn-nsfw" disabled>–ù–µ–ø—Ä–∏–µ–º–ª–µ–º–æ</button>
            ‚Äì —Ü–∏—Ç–∞—Ç–∞ –Ω–µ–ø—Ä–∏–µ–º–ª–µ–º–∞. –°–ø–∞—Å–∏–±–æ, —á—Ç–æ —Å–æ–æ–±—â–∏–ª–∏!
        </div>
        <div class="welcome-subheader">–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º</div>
        <div>–ï—Å–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤ –ø—Ä–∞–≤–æ–º —É–≥–ª—É –æ—Ä–∞–Ω–∂–µ–≤—ã–π, —Ñ–∏–ª—å—Ç—Ä –æ—Ç–∫–ª—é—á–µ–Ω –∏ –≤–∞–º –º–æ–≥—É—Ç –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –Ω–µ–ø—Ä–∏–µ–º–ª–µ–º—ã–µ —Ü–∏—Ç–∞—Ç—ã. –ß—Ç–æ–±—ã
            —É–±—Ä–∞—Ç—å –∏—Ö,
            –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–µ–≥–æ.
        </div>
        <div class="welcome-subheader">–°–≤—è–∑–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</div>
        <div>
            <button class="link-devices-btn-welcome" disabled>–°–≤—è–∑–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</button>
            ‚Äì –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞ –¥—Ä—É–≥–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ, –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É.
        </div>
        <div class="welcome-subheader">–ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ —Å—Å—ã–ª–∫–∏</div>
        <div class="welcome-links">–ü–æ –≤—Å–µ–º –≤–æ–ø—Ä–æ—Å–∞–º –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ <a href="https://t.me/kglebaa" target="_blank">@kglebaa</a>. –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ
            –ø—Ä–æ–µ–∫—Ç–µ –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å –ø–æ <a href="https://kgleba.notion.site/a01c49ed9f2b433c855fa9b736eec7f9" target="_blank">—Å—Å—ã–ª–∫–µ</a>.
        </div>
        <br><br>
        <button class="close-btn" onclick="closeWelcomeModal(event)">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
</div>


<!-- Linking modal -->
<div id="linking-modal" onclick="closeLinkingModal(event)">
    <div id="welcome-content" onclick="event.stopPropagation()">
        <div class="welcome-subheader">–°–≤—è–∑–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</div>
        <div>
            <button id="generate-btn" onclick="codeGenerating()">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
            ‚Äì –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ (—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å —ç—Ç–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞). –ó–∞—Ç–µ–º, –≤–≤–µ–¥–∏—Ç–µ –µ–≥–æ –Ω–∞ —ç—Ç–æ–º –∂–µ —Å–∞–π—Ç–µ –Ω–∞
            —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ, –∫—É–¥–∞ —Ö–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.
        </div>
        <div style='text-align: center; margin: 10px 0'>–ò–õ–ò</div>
        <div><input type="text" placeholder="–í–∞—à –∫–æ–¥" id='linking-input' maxlength=8> ‚Äì –≤–≤–µ–¥–∏—Ç–µ –∫–æ–¥, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –Ω–∞ –¥—Ä—É–≥–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ, —á—Ç–æ–±—ã
            –æ—Ç–∫—Ä—ã—Ç—å —Ç—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ.
        </div>
        <div></div>
        <br><br>
        <button class="close-btn" onclick="closeLinkingModal(event)">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.4.0/dist/confetti.browser.min.js"></script>
<script>

    function launchConfetti() {
        var end = Date.now() + (3000);

        var colors = ['#34d058', '#f66a6a', '#ffdf7e', '#6d8af3'];

        (function frame() {
            confetti({
                particleCount: 4,
                angle: 20,
                spread: 120,
                origin: {x: 0},
                colors: colors
            });
            confetti({
                particleCount: 4,
                angle: 160,
                spread: 120,
                origin: {x: 1},
                colors: colors
            });

            if (Date.now() < end) {
                requestAnimationFrame(frame);
            }
        }());
    }

    let nsfw_mod = true;
    let currentNSFW = 0;
    let internalId = null;

    const awards = {};

    awards['#10'] = "What time is it? Showtime! –û—Ç–ª–∏—á–Ω–æ–µ –Ω–∞—á–∞–ª–æ - 10 —Ü–∏—Ç–∞—Ç —É–∂–µ –µ—Å—Ç—å =D";
    awards['#50'] = "Into the woods... –ü—Ä–æ–¥–æ–ª–∂–∏–º? 50 —Ü–∏—Ç–∞—Ç —É–∂–µ –ø—Ä–æ–π–¥–µ–Ω–æ :)";
    awards['#100'] = "I'm not throwing away my shot! –£–∂–µ 100 —Ü–∏—Ç–∞—Ç –∏ –≤—ã –µ—â–µ —Å –Ω–∞–º–∏ ;)";
    awards['#500'] = "Fetch... so fetch! –í—ã - –≥–µ—Ä–æ–π. –ò –º—ã –∫—Ä–∞–π–Ω–µ –≤–∞–º –ø—Ä–∏–∑–Ω–∞—Ç–µ–ª—å–Ω—ã –∑–∞ —ç—Ç–∏ 500 —Ü–∏—Ç–∞—Ç.";
    awards['#1000'] = "Live long and prosper! –ë–µ–∑ –≤–∞—Å –Ω–∏—á–µ–≥–æ –±—ã –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å, –≤–µ–¥—å —É–∂–µ 1000 —Ü–∏—Ç–∞—Ç –ø–æ–∑–∞–¥–∏ ;D";

    const windowInnerWidth = window.innerWidth;
    const sizeOfQuoteContainer = Math.min(Math.floor(0.75 * windowInnerWidth), 1000)
    document.getElementById('quote-container').style.maxWidth = sizeOfQuoteContainer.toString() + 'px';
    if (sizeOfQuoteContainer > 450) {
        document.getElementById('quote-text').style.fontSize = '30px';
        document.getElementsByClassName('channel-link')[0].style.fontSize = '25px';
    } else if (sizeOfQuoteContainer > 350) {
        document.getElementById('quote-text').style.fontSize = '25px';
        document.getElementsByClassName('channel-link')[0].style.fontSize = '20px';
    } else {
        document.getElementById('quote-text').style.fontSize = '20px';
        document.getElementsByClassName('channel-link')[0].style.fontSize = '18px';
        document.getElementsByClassName('btn-positive')[0].textContent = 'üëç';
        document.getElementsByClassName('btn-negative')[0].textContent = 'üëé';
        document.getElementsByClassName('btn-positive')[1].textContent = 'üëç';
        document.getElementsByClassName('btn-negative')[1].textContent = 'üëé';
    }

    toastr.options = {
        "closeButton": true,
        "debug": false,
        "newestOnTop": true,
        "progressBar": true,
        "positionClass": "toast-bottom-right",
        "preventDuplicates": true,
        "onclick": null,
        "showDuration": "300",
        "hideDuration": "1000",
        "timeOut": "2000",
        "extendedTimeOut": "1000",
        "showEasing": "swing",
        "hideEasing": "linear",
        "showMethod": "fadeIn",
        "hideMethod": "fadeOut"
    };

    function toggleTheme() {
        const currentTheme = document.body.classList.contains('light-theme') ? 'light-theme' : 'dark-theme';
        const newTheme = currentTheme === 'light-theme' ? 'dark-theme' : 'light-theme';
        applyTheme(newTheme);
    }

    function applyTheme(theme) {
        document.body.className = theme;
        localStorage.setItem('theme', theme);
    }

    function getStoredTheme() {
        return localStorage.getItem('theme');
    }

    function applyMod(mod) {
        if (mod === 'nsfw-mod') {
            nsfw_mod = true;
            localStorage.setItem('mod', 'nsfw-mod');
        } else {
            nsfw_mod = false;
            localStorage.setItem('mod', 'safe-mod');
        }

    }

    function getStoredMod() {
        return localStorage.getItem('mod');
    }

    function showWelcomeModal() {
        document.getElementById('welcome-modal').style.display = 'block';
        document.getElementsByClassName('copy-btn')[0].textContent = '‚ßâ';
    }

    function closeWelcomeModal(event) {
        document.getElementById('welcome-modal').style.display = 'none';
    }

    function showLinkingModal() {
        document.getElementById('linking-modal').style.display = 'block';
        document.getElementById('generate-btn').textContent = '–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥';
        document.getElementById('generate-btn').style.pointerEvents = "all";
        document.getElementById('generate-btn').style.opacity = "1";
        document.getElementById('linking-input').style.borderColor = '#008cba';
        document.getElementById('linking-input').style.color = 'black';
        document.getElementById('linking-input').value = '';
        document.getElementById('linking-input').style.pointerEvents = "all";
        document.getElementById('linking-input').style.opacity = "1";
    }

    function closeLinkingModal(event) {
        document.getElementById('linking-modal').style.display = 'none';
    }

    document.addEventListener('keydown', function (event) {
        if (event.key === "Escape") {
            closeWelcomeModal();
            closeLinkingModal();
        }
    });

    async function nsfwOn(event) {

        if (nsfw_mod === false) {
            document.getElementsByClassName('nsfw-btn')[0].style.backgroundColor = '#ed7a2b';
            document.getElementsByClassName('nsfw-btn')[0].textContent = '–ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º';
            nsfw_mod = true;

        } else {
            document.getElementsByClassName('nsfw-btn')[0].style.backgroundColor = '#008cba';
            document.getElementsByClassName('nsfw-btn')[0].textContent = '–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º';
            if (currentNSFW > 0) {
                await proceed();
            }
            nsfw_mod = false;
        }

        if (nsfw_mod === true) {
            applyMod('nsfw-mod');
        } else {
            applyMod('safe-mod');
        }
    }

    async function getQuote() {
        try {
            const response = await fetch(`/get_quote?nsfw_filter=${!nsfw_mod}`);
            if (!response.ok) throw new Error('Failed to fetch quote');
            const data = await response.json();
            document.getElementById('quote-text').innerHTML = data.text.replace(/\n/g, '<br>');
            document.getElementById('channel-link').href = data.channel_link;
            document.getElementById('channel-link').textContent = data.channel_name;
            document.getElementsByClassName('btn-nsfw')[0].style.pointerEvents = "all";
            document.getElementsByClassName('btn-nsfw')[0].style.opacity = "1";
            internalId = data.internal_id;
            currentNSFW = data.nsfw;

            document.getElementById('quote-cnt').textContent = '#' + data.vote_streak.toString();

            if (document.getElementById('quote-cnt').textContent in awards) {
                toastr.options.timeOut = 5000;
                toastr.success(awards[document.getElementById('quote-cnt').textContent]);
                launchConfetti();
                toastr.options.timeOut = 2000;
            }
        } catch (error) {
            console.log('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ü–∏—Ç–∞—Ç—ã: ' + error.message);
        }
    }

    async function proceed() {
        try {
            await fetch('/proceed');
        } catch (error) {
            console.log('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ü–∏—Ç–∞—Ç—ã: ' + error.message);
        }
        await getQuote();
    }

    async function nsfwQuote() {
        if (!internalId) {
            toastr.warning('–¶–∏—Ç–∞—Ç–∞ –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞.');
            return;
        }

        const formData = new FormData();
        formData.append('internal_id', internalId);
        try {
            const response = await fetch('/mark_nsfw', {
                method: 'POST',
                body: formData
            });

            if (response.ok) {
                toastr.success('–¶–∏—Ç–∞—Ç–∞ –ø–æ–º–µ—á–µ–Ω–∞ –∫–∞–∫ NSFW. –°–ø–∞—Å–∏–±–æ!');
                document.getElementsByClassName('btn-nsfw')[0].style.pointerEvents = "none";
                document.getElementsByClassName('btn-nsfw')[0].style.opacity = "0.3";
                currentNSFW += 1;
            } else if (response.status === 400) {
                toastr.error('–ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å.');
            } else if (response.status === 403) {
                toastr.error('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É');
            } else {
                toastr.error('–ö–∞–∂–µ—Ç—Å—è, –º—ã —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–ª–∏ :(');
            }
        } catch (error) {
            console.log('–û—à–∏–±–∫–∞: ' + error.message);
        }
    }


    async function vote(voteType) {
        if (!internalId) {
            toastr.warning('–¶–∏—Ç–∞—Ç–∞ –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞.');
            return;
        }

        const formData = new FormData();
        formData.append('internal_id', internalId);
        formData.append('vote', voteType);

        try {
            const response = await fetch('/vote', {
                method: 'POST',
                body: formData
            });
            const data = await response.json();

            if (response.ok) {
                toastr.success('–ì–æ–ª–æ—Å —É—Å–ø–µ—à–Ω–æ —É—á—Ç—ë–Ω!');
            } else if (response.status === 400) {
                toastr.error('–ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å.');
            } else if (response.status === 403) {
                toastr.error('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É');
            } else {
                toastr.error('–ö–∞–∂–µ—Ç—Å—è, –º—ã —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–ª–∏ :(');
            }

            if (data.skip) {
                await proceed();
            } else {
                await getQuote();
            }
        } catch (error) {
            console.log('–û—à–∏–±–∫–∞: ' + error.message);
        }
    }

    async function report() {
        if (!internalId) {
            toastr.warning('–¶–∏—Ç–∞—Ç–∞ –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞.');
            return;
        }

        const formData = new FormData();
        formData.append('internal_id', internalId);

        try {
            const response = await fetch('/report', {
                method: 'POST',
                body: formData
            });

            if (response.ok) {
                toastr.success('–°–ø–∞—Å–∏–±–æ! –í–∏–¥–∏–º–æ, –º—ã —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫ —Ä–∞—Å–ø–∞—Ä—Å–∏–ª–∏ ;)');
            } else if (response.status === 400) {
                toastr.error('–ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å.');
            } else if (response.status === 403) {
                toastr.error('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É');
            } else {
                toastr.error('–ö–∞–∂–µ—Ç—Å—è, –º—ã —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–ª–∏ :(');
            }
        } catch (error) {
            console.log('–û—à–∏–±–∫–∞: ' + error.message);
        }

        await proceed();
    }

    function copyLink() {
        const link = "https://quotes.kgleba.ru";
        navigator.clipboard.writeText(link).then(() => {
            toastr.success('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
            document.getElementsByClassName('copy-btn')[0].textContent = '‚úì';
            copied = true;
        }, (err) => {
            console.log('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å—Å—ã–ª–∫–∏: ' + err);
        });
    }

    async function codeGenerating() {
        try {
            const response = await fetch('/sync_data', {
                method: 'POST',
            });
            if (!response.ok) throw new Error('Failed to fetch... so fetch... and feeearless!!');
            const data = await response.json();
            document.getElementById('generate-btn').innerHTML = "–í–∞—à –∫–æ–¥: " + data.token.toString();
            document.getElementById('generate-btn').style.pointerEvents = "none";
            document.getElementById('generate-btn').style.opacity = "0.7";
        } catch (error) {
            toastr.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞: ' + error.message);
        }
    }

    async function codeChecking(token) {
        try {
            const formData = new FormData();
            formData.append('token', token);
            const response = await fetch('/sync_data', {
                method: 'POST',
                body: formData
            });
            if (response.ok) {
                document.getElementById('linking-input').style.borderColor = '#28a745';
                document.getElementById('linking-input').style.color = '#28a745';
                document.getElementById('linking-input').style.pointerEvents = "none";
                document.getElementById('linking-input').style.opacity = "0.7";
                toastr.success('–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!');
                await getQuote();
            } else if (response.status === 400) {
                document.getElementById('linking-input').style.borderColor = '#dc3545';
                document.getElementById('linking-input').style.color = '#dc3545';
                toastr.error('–£–∫–∞–∑–∞–Ω –Ω–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥.');
            } else {
                toastr.error('–ö–∞–∂–µ—Ç—Å—è, –º—ã —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–ª–∏ :(');
            }
        } catch (error) {
            toastr.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ü–∏—Ç–∞—Ç—ã: ' + error.message);
            codeIncorrect();
        }
    }

    document.getElementById('linking-input').addEventListener('input', function (event) {
        if (document.getElementById('linking-input').value.length != 8) {
            document.getElementById('linking-input').style.borderColor = '#008cba';
            document.getElementById('linking-input').style.color = 'black';
        } else {
            codeChecking(document.getElementById('linking-input').value);
        }
    });

    window.onload = () => {
        const storedTheme = getStoredTheme() || 'dark-theme';
        applyTheme(storedTheme);
        const storedMod = getStoredMod() || 'nsfw-mod';
        if (storedMod === 'safe-mod') {
            nsfwOn(true);
        }
        applyMod(storedMod);
        getQuote();
    };
</script>

</body>
</html>